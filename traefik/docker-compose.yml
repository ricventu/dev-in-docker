version: '3'
# https://doc.traefik.io/traefik/getting-started/quick-start/#launch-traefik-with-the-docker-provider
services:
  traefik:
    container_name: did_traefik
    # The official v2 Traefik docker image
    image: traefik:v2.6
    # Enables the web UI and tells Traefik to listen to docker
    command: 
      - --api.insecure=true 
      - --providers.docker=true
      - --providers.docker.exposedByDefault=false
    labels:
      - "traefik.enable=true"
      - traefik.port=80
    ports:
      # The HTTP port
      - "${HTTP_PORT:-80}:80"
      # The Web UI (enabled by --api.insecure=true)
      - "${UI_PORT:-8080}:8080"
    volumes:
      # So that Traefik can listen to the Docker events
      - /var/run/docker.sock:/var/run/docker.sock:ro
    networks:
      - gateway

networks:
  gateway:
    name: gateway